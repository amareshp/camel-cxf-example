<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:camel="http://camel.apache.org/schema/spring"
    xmlns:cxf="http://camel.apache.org/schema/cxf"
    xsi:schemaLocation="
       http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
       http://camel.apache.org/schema/spring http://camel.apache.org/schema/spring/camel-spring.xsd
       http://camel.apache.org/schema/cxf http://camel.apache.org/schema/cxf/camel-cxf.xsd">
    <!-- We still need it for loading the CXFServlet -->
    <import resource="classpath:META-INF/cxf/cxf.xml" />
    <!-- use camel-metrics route policy to gather metrics for all routes -->
    <bean id="metricsRoutePolicyFactory"
        class="org.apache.camel.component.metrics.routepolicy.MetricsRoutePolicyFactory" />
    <!-- a rest service which uses binding to/from pojos -->
    <bean id="userRoutes" class="com.visitamaresh.ws.demo.CamelRoute" />
    <!-- a bean for user services -->
    <bean id="userService" class="com.visitamaresh.ws.demo.UserService" />
    <camelContext xmlns="http://camel.apache.org/schema/spring">
        <!-- configure rest to use the camel-servlet component, and use json
            binding mode -->
        <!-- and tell to output json in pretty print mode -->
        <!-- setup context path and port number that Apache Tomcat will deploy
            this application with,
            as we use the servlet component, then we need to aid Camel to
            tell it these details so Camel
            knows the url to the REST services.
            Notice: This is optional, but needed if the RestRegistry should
            enlist accurate information.
            You can access the RestRegistry from JMX at runtime -->
        <restConfiguration component="servlet"
            bindingMode="json" contextPath="camel-cxf-example/camel"
            port="8080">
            <dataFormatProperty key="prettyPrint"
                value="true" />
        </restConfiguration>
        <!-- defines the rest services using the context-path /user -->
        <rest path="/user" consumes="application/json" produces="application/json">
            <description>User rest service</description>
            <!-- this is a rest GET to view an user by the given id -->
            <get uri="/{id}" outType="com.visitamaresh.ws.demo.User">
                <description>Find user by id</description>
                <to uri="bean:userService?method=getUser(${header.id})" />
            </get>
            <!-- this is a rest PUT to create/update an user -->
            <put type="com.visitamaresh.ws.demo.User">
                <description>Updates or create a user</description>
                <to uri="bean:userService?method=updateUser" />
            </put>
            <!-- this is a rest GET to find all users -->
            <get uri="/findAll" outType="com.visitamaresh.ws.demo.User[]">
                <description>Find all users</description>
                <to uri="bean:userService?method=listUsers" />
            </get>
        </rest>
    </camelContext>
</beans>